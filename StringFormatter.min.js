!function(t){function e(t,e,s,n){var r,i,a,p=n||"",u=p.indexOf("g")>-1,c=new RegExp(e+"|"+s,(u?"":"g")+p),o=new RegExp(e,p.replace(/g/g,"")),h=[];do for(r=0;a=c.exec(t);)if(o.test(a[0]))r++||(i=c.lastIndex);else if(r&&!--r&&(h.push(t.slice(i,a.index)),!u))return h;while(r&&(c.lastIndex=i));return h}function s(t,e,s,n,r,i){var a,p,u,c,o=n||"",h=o.indexOf("g")>-1,f=new RegExp(e+"|"+s,(h?"":"g")+o),d=new RegExp(e,o.replace(/g/g,"")),l=t.slice(),g=i?"":e.replace("\\",""),b=i?"":s.replace("\\","");do for(a=0;u=f.exec(t);)if(d.test(u[0]))a++||(p=f.lastIndex);else if(a&&!--a&&(c=t.slice(p,u.index),l=l.replace(g+c+b,r),!h))return l;while(a&&(f.lastIndex=p));return l}function n(t){var e=t+"",s=e.indexOf("function ");if(-1===s)return null;var n=s+"function ".length,r=e.indexOf("(",n);return-1===r?null:e.substring(n,r)}function r(t,e){this.spec=t,this.func=e}function i(t,e){this.spec=t,this.date=new Date(e)}function a(){var t=this;t.cache={},t.gcOn=!0,t.hits=0,t.gcThreshold=1e3,t.gcPurgeLessThan=1,t.formats={string:function(t,e){var s=e+"",n="";if(t.width){var r=t.width-s.length;r>0&&(n=(t.padding?t.padding:"").repeat(r))}return s=n+s},number:function(t,e){var s=parseFloat(e),n="";if(s+""=="NaN")return null!=t.ifNaN?t.ifNaN:s;if(s===1/0||s===-(1/0))return null!=t.ifInfinity?t.ifInfinity:s;if(null!=t.precision&&(s=s.toPrecision(t.precision)),null!=t.fixed&&(s=parseFloat(s).toFixed(t.fixed)),t.as)switch(t.as[0]){case"%":s+="%";break;case"h":s=(s>=0?"0x":"-0x")+s.toString(16).replace("-","");break;case"o":s=(s>=0?"0":"-0")+s.toString(8).replace("-","");break;case"b":s=s.toString(2);break;case"e":s=s.toExponential()}if(t.width){var r=s+"",i=r.length-(t.sign?t.sign.length:0);i>0&&(n=(t.padding?t.padding:"0").repeat(i))}return s=t.sign&&parseInt(s)<0?(t.sign instanceof Array?t.sign[0]:t.sign)+n+s+(t.sign instanceof Array?t.sign[1]:t.sign):n+s,s=t.currency?t.currency+s:s,s=t.accounting&&0>e?"("+(s+"").replace("-","")+")":s},"boolean":function(t,e){var s,n=e,r="";switch(t.as){case"string":n=e?"yes":"no";break;case"number":n=e?1:0;break;default:n=e?!0:!1}return t.width&&(s=t.padding-n.length,s>0&&(r=(t.padding?t.padding:"").repeat(s))),r+n}},t.formats.object=t.formats.Object,t.formats["function"]=t.formats.Function}function p(t,e){function s(e){return t.include?t.include.indexOf(e)>=0:t.exclude?-1===t.exclude.indexOf(e):!0}var n,r={};for(var i in t)"width"!==i&&"padding"!==i&&(r[i]=t[i]);if(this instanceof Object){var a=this,p=Object.keys(this),u={};p.forEach(function(n){s(n)&&(a[n]instanceof Object?e.formats[a[n].constructor.name]?u[n]=e.formats[a[n].constructor.name].call(a[n],r,e):u[n]=e.formats.Object.call(a[n],r,e):(!t.matchValue||t.matchValue.test&&t.matchValue.test(a[n]+""))&&(u[n]=e.formats[typeof a[n]](r,a[n])))}),n=JSON.stringify(u)}var c="";if(t.width){var o=t.padding-n.length;o>0&&(c=(t.padding?t.padding:"").repeat(o))}return n=c+n}function u(t,e){function s(e){return t.include?t.include.some(function(t){return e===t||t instanceof Array&&e>=t[0]&&e<=t[1]?!0:!1})?!0:!1:t.exclude&&t.exclude.some(function(t){return e===t||t instanceof Array&&e>=t[0]&&e<=t[1]?!0:!1})?!1:!0}var n,r=t.delimiter?t.delimiter:",",i=t.container?t.container:["",""],a={};for(var p in t)"width"!==p&&"padding"!==p&&(a[p]=t[p]);if(this instanceof Array){for(var u=[],c=0;c<this.length;c++)if(s(c)){var o=this[c];o instanceof Object?u.push(e.formats[o.constructor.name]?(t.quote?"'":"")+e.formats[o.constructor.name].call(o,a,e)+(t.quote?"'":""):(t.quote?"'":"")+e.formats.Object.call(o,a,e)+(t.quote?"'":"")):(!t.matchValue||t.matchValue.test&&t.matchValue.test(o+""))&&u.push((t.quote?"'":"")+e.formats[typeof o](a,o)+(t.quote?"'":""))}n=i[0]+u.join(r)+i[1]}var h="";if(t.width){var f=t.padding-n.length;f>0&&(h=(t.padding?t.padding:"").repeat(f))}return n=h+n}function c(t){var e=new i(t.format,this);return e.format()}function o(t){var e=new r(t.format,this);return e.format()}r.prototype.format=function(){if(!this.spec)return this.func+"";var t=[];t.push(this.getValue()),t.push(this.getHead()),t.push(this.getArguments()),t.push(this.getBody()),t.push(this.getLength()),t.push(this.getNameAnonymous()),t.push(this.getName());var e=""+this.spec;return t.forEach(function(t){t&&(e=e.replace(t.pattern,t.substitute))}),e},r.prototype.getValue=function(){return this.spec.indexOf("v")>=0?{substitute:this.func(),pattern:"v"}:null},r.prototype.getHead=function(){if(this.spec.indexOf("h")>=0){var t=this.func+"",e=t.indexOf(" {");return{substitute:t.substring(0,e),pattern:"h"}}return null},r.prototype.getArguments=function(){if(this.spec.indexOf("a")>=0){var t,e=this.func+"",s=e.indexOf("("),n=e.indexOf(")");return s>=0&&n>=0&&n>s&&(t=e.substring(s+1,n)),{substitute:t.split(",").join(", "),pattern:"a"}}return null},r.prototype.getBody=function(){if(this.spec.indexOf("b")>=0){var t=this.func+"",e=t.indexOf("{"),s=t.lastIndexOf("}");return{substitute:t.substring(e+2,s-1),pattern:"b"}}return null},r.prototype.getLength=function(){return this.spec.indexOf("l")>=0?{substitute:this.func.length,pattern:"l"}:null},r.prototype.getNameAnonymous=function(){if(this.spec.indexOf("N")>=0){var t=n(this.func);return{substitute:null==t||0===t.length?"anonymous":t,pattern:"N"}}return null},r.prototype.getName=function(){if(this.spec.indexOf("n")>=0&&-1===this.spec.indexOf("na")){var t=n(this.func);return{substitute:null==t||""===t?"":t,pattern:"n"}}return null},i.prototype.format=function(){if(!this.spec)return this.date.toString();var t=[];t.push(this.getMonth()),t.push(this.getQuarter()),t.push(this.getYear()),t.push(this.getDayOfYear()),t.push(this.getDayOfMonth()),t.push(this.getDayOfWeek()),t.push(this.getAMPM()),t.push(this.getHours()),t.push(this.getMinutes()),t.push(this.getSeconds()),t.push(this.getMilliseconds()),t.push(this.getTime()),t.push(this.getTimezoneOffset()),t.push(this.toUTCString()),t.push(this.toGMTString()),t.push(this.toISOString()),t.push(this.toLocaleString()),t.push(this.toTimeString());var e=""+this.spec;return t.forEach(function(t){t&&(e=e.replace(t.pattern,t.substitute))}),e},i.prototype.getMonth=function(){var t,e=this.date.getMonth(),s=["January","February","March","April","May","June","July","August","September","October","November","December"];if(this.spec.indexOf("MMMM")>=0)t={substitute:s[e],pattern:"MMMM"};else if(this.spec.indexOf("MMM")>=0)t={substitute:s[e].substring(0,3),pattern:"MMM"};else if(this.spec.indexOf("MM")>=0)t={substitute:9>e?"0"+(e+1):""+(e+1),pattern:"MM"};else if(this.spec.indexOf("Mo")>=0)switch(e){case 0:t={substitute:"1st",pattern:"Mo"};break;case 1:t={substitute:"2nd",pattern:"Mo"};break;case 2:t={substitute:"3rd",pattern:"Mo"};break;default:t={substitute:e+1+"th",pattern:"Mo"}}else this.spec.indexOf("M")>=0&&(t={substitute:""+(1+e),pattern:"M"});return t&&(this.spec=this.spec.replace(t.pattern,"@"+t.pattern),t.pattern="@"+t.pattern),t},i.prototype.getQuarter=function(){var t=this.date.getMonth();return this.spec.indexOf("Q")>=0&&(3>t?result={substitute:"1",pattern:"Q"}:6>t?result={substitute:"2",pattern:"Q"}:9>t?result={substitute:"3",pattern:"Q"}:result={substitute:"4",pattern:"Q"}),result&&(this.spec=this.spec.replace(result.pattern,"@"+result.pattern),result.pattern="@"+result.pattern),result},i.prototype.getYear=function(){var t,e=this.date.getFullYear()+"";return this.spec.indexOf("YYYY")>=0?t={substitute:e,pattern:"YYYY"}:this.spec.indexOf("YY")>=0&&(t={substitute:e.substring(2),pattern:"YY"}),t&&(this.spec=this.spec.replace(t.pattern,"@"+t.pattern),t.pattern="@"+t.pattern),t},i.prototype.getDayOfYear=function(){var t,e=new Date(this.date);e.setHours(23);var s=Math.round((e-new Date(e.getFullYear(),0,1,0,0,0))/1e3/60/60/24);return this.spec.indexOf("DDDD")>=0?t={substitute:10>s?"00"+s:100>s?"0"+s:""+s,pattern:"DDDD"}:this.spec.indexOf("DDDo")>=0?(s+="",s=s.lastIndexOf("1")===s.length+1?s+"st":s.lastIndexOf("2")===s.length+1?s+"nd":s.lastIndexOf("3")===s.length+1?s+"rd":s+"th",t={substitute:s,pattern:"DDDo"}):this.spec.indexOf("DDD")>=0&&(t={substitute:""+s,pattern:"DDD"}),t&&(this.spec=this.spec.replace(t.pattern,"@"+t.pattern),t.pattern="@"+t.pattern),t},i.prototype.getDayOfMonth=function(){var t,e=this.date.getDate();if(this.spec.indexOf("DD")>=0)t=10>e?{substitute:"0"+e,pattern:"DD"}:{substitute:""+e,pattern:"DD"};else if(this.spec.indexOf("Do")>=0)switch(e){case 1:t={substitute:"1st",pattern:"Do"};break;case 2:t={substitute:"2nd",pattern:"Do"};break;case 3:t={substitute:"3rd",pattern:"Do"};break;case 21:t={substitute:"21st",pattern:"Do"};break;case 22:t={substitute:"22nd",pattern:"Do"};break;case 23:t={substitute:"23rd",pattern:"Do"};break;case 31:t={substitute:"31st",pattern:"Do"};break;default:return{substitute:e+"th",pattern:"Do"}}else this.spec.indexOf("D")>=0&&(t={substitute:""+e,pattern:"D"});return t&&(this.spec=this.spec.replace(t.pattern,"@"+t.pattern),t.pattern="@"+t.pattern),t},i.prototype.getDayOfWeek=function(){var t,e=this.date.getDay(),s=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];if(this.spec.indexOf("dddd")>=0)t={substitute:s[e],pattern:"dddd"};else if(this.spec.indexOf("ddd")>=0)t={substitute:s[e].substring(0,3),pattern:"ddd"};else if(this.spec.indexOf("dd")>=0)t={substitute:s[e].substring(0,2),pattern:"dd"};else if(this.spec.indexOf("do")>=0)switch(e){case 0:t={substitute:"1st",pattern:"do"};break;case 1:t={substitute:"2nd",pattern:"do"};break;case 2:t={substitute:"3rd",pattern:"do"};break;default:t={substitute:e+1+"th",pattern:"do"}}else this.spec.indexOf("d")>=0&&(t={substitute:""+e,pattern:"d"});return t&&(this.spec=this.spec.replace(t.pattern,"@"+t.pattern),t.pattern="@"+t.pattern),t},i.prototype.getHours=function(){var t,e=this.date.getHours();return this.spec.indexOf("HH")>=0?t={substitute:10>e?"0"+e:""+e,pattern:"HH"}:this.spec.indexOf("H")>=0?t={substitute:""+e,pattern:"H"}:(e=0===e?12:e,e=e>12?e-12:e,this.spec.indexOf("hh")>=0?t={substitute:10>e?"0"+e:""+e,pattern:"hh"}:this.spec.indexOf("h")>=0&&(t={substitute:""+e,pattern:"h"})),t&&(this.spec=this.spec.replace(t.pattern,"@"+t.pattern),t.pattern="@"+t.pattern),t},i.prototype.getAMPM=function(){var t,e=this.date.getHours();return this.spec.indexOf("A")>=0?t={substitute:e>11?"PM":"AM",pattern:"A"}:this.spec.indexOf("a")>=0&&(t={substitute:e>11?"pm":"am",pattern:"a"}),t&&(this.spec=this.spec.replace(t.pattern,"@"+t.pattern),t.pattern="@"+t.pattern),t},i.prototype.getMinutes=function(){var t,e=this.date.getMinutes();return this.spec.indexOf("mm")>=0?t={substitute:10>e?"0"+e:e+"",pattern:"mm"}:this.spec.indexOf("m")>=0&&(t={substitute:e+"",pattern:"m"}),t&&(this.spec=this.spec.replace(t.pattern,"@"+t.pattern),t.pattern="@"+t.pattern),t},i.prototype.getSeconds=function(){var t,e=this.date.getSeconds();return this.spec.indexOf("ss")>=0?t={substitute:10>e?"0"+e:e+"",pattern:"ss"}:this.spec.indexOf("s")>=0&&(t={substitute:e+"",pattern:"s"}),t&&(this.spec=this.spec.replace(t.pattern,"@"+t.pattern),t.pattern="@"+t.pattern),t},i.prototype.getMilliseconds=function(){function t(t,e,s,n){return t=(t||s||0)+"",e=new Array((++e||3)-t.length).join(s||0),n?t+e:e+t}var e,s=this.date.getMilliseconds()+"";return s=t(s,3,"0"),this.spec.indexOf("SSS")>=0?e={substitute:s,pattern:"SSS"}:this.spec.indexOf("SS")>=0?e={substitute:s.substring(0,2),pattern:"SS"}:this.spec.indexOf("S")>=0&&(e={substitute:s.substring(0,1),pattern:"S"}),e&&(this.spec=this.spec.replace(e.pattern,"@"+e.pattern),e.pattern="@"+e.pattern),e},i.prototype.getTime=function(){var t,e=this.date.getTime()+"";return this.spec.indexOf("X")>=0&&(t={substitute:e,pattern:"X"}),t&&(this.spec=this.spec.replace(t.pattern,"@"+t.pattern),t.pattern="@"+t.pattern),t},i.prototype.getTimezoneOffset=function(){var t,e=this.date.getTimezoneOffset(),s=0>e?!0:!1,n=Math.abs(e/60),r=parseInt(n)+"";r=10>r?"0"+r:r+"",r=s?"-"+r:"+"+r;var i=Math.abs(e%60);return i=10>i?"0"+i:i+"",this.spec.indexOf("ZZ")>=0?t={substitute:r+":"+i,pattern:"ZZ"}:this.spec.indexOf("Z")>=0&&(t={substitute:r+i,pattern:"Z"}),t&&(this.spec=this.spec.replace(t.pattern,"@"+t.pattern),t.pattern="@"+t.pattern),t},i.prototype.toUTCString=function(){var t;return this.spec.indexOf("U")>=0&&(t={substitute:this.date.toUTCString().replace("GMT","UTC"),pattern:"U"}),t&&(this.spec=this.spec.replace(t.pattern,"@"+t.pattern),t.pattern="@"+t.pattern),t&&(this.spec=this.spec.replace(t.pattern,"@"+t.pattern),t.pattern="@"+t.pattern),t},i.prototype.toGMTString=function(){var t;return this.spec.indexOf("G")>=0&&(t={substitute:this.date.toUTCString().replace("UTC","GMT"),pattern:"G"}),t&&(this.spec=this.spec.replace(t.pattern,"@"+t.pattern),t.pattern="@"+t.pattern),t},i.prototype.toISOString=function(){var t;return this.spec.indexOf("I")>=0&&(t={substitute:this.date.toISOString(),pattern:"I"}),t&&(this.spec=this.spec.replace(t.pattern,"@"+t.pattern),t.pattern="@"+t.pattern),t},i.prototype.toLocaleString=function(){var t;return this.spec.indexOf("L")>=0&&(t={substitute:this.date.toLocaleString(),pattern:"L"}),t&&(this.spec=this.spec.replace(t.pattern,"@"+t.pattern),t.pattern="@"+t.pattern),t},i.prototype.toTimeString=function(){var t;return this.spec.indexOf("T")>=0?t={substitute:this.date.toTimeString(),pattern:"T"}:this.spec.indexOf("t")>=0&&(t={substitute:this.date.toLocaleTimeString(),pattern:"t"}),t&&(this.spec=this.spec.replace(t.pattern,"@"+t.pattern),t.pattern="@"+t.pattern),t},a.prototype.gc=function(){for(var t in this.cache)this.cache[t].hits<=this.gcPurgeLessThan&&delete this.cache[t]},a.prototype.register=function(t,e,s){s||(s=t.name),this.formats[s]=e?e:t.prototype.StringFormatter},a.prototype.polyfill=function(){var t=this;String.prototype.format=function(){var e=Array.prototype.slice.call(arguments,0);e.unshift(this);var s=t.format.apply(t,e);return s.substring(1,s.length-2)}},a.prototype.format=function(t){var n=this,r=Array.prototype.slice.call(arguments,1),i=t instanceof Object?JSON.stringify(t):t;n.hits++,n.gcOn&&n.hits>=n.gcThreshold&&n.gc();var a=this.cache[i];if(!a){a={patterns:[],statics:[],hits:0},-1===i.indexOf("@value")&&-1===i.indexOf("@arguments")&&(this.cache[i]=a);var p=s(i,"\\{","\\}","g","@!$format$!@");a.statics=p.split("@!$format$!@"),a.patterns=e(i,"\\{","\\}","g"),a.patterns&&a.patterns.forEach(function(t,e){t.indexOf(":")>=0?(t=t.replace(/@value/g,"$value"),t=t.replace(/@argumentse/g,"$arguments"),a.patterns[e]=Function("$value","$arguments","return {"+t+"}")(r[e],r)):(a.patterns[e]={},a.patterns[e][t]={})})}a.hits++;var u=[];return r=arguments,a.statics.forEach(function(t,e){if(u.push(t),e<r.length-1&&e<a.patterns.length){var s=r[e+1],i=a.patterns[e],p=Object.keys(i)[0],c=i[p],o="function"==typeof n.formats[p]?s instanceof Object?n.formats[p].call(s,c,n):n.formats[p](c,s):i;c.style&&(o="<span style='"+c.style+"'>"+o+"</span>"),u.push(o)}}),u.join("")},t.StringFormatter=new a,t.StringFormatter.register(Array,u,"Array"),t.StringFormatter.register(Object,p,"Object"),t.StringFormatter.register(Object,p,"object"),t.StringFormatter.register(Date,c,"Date"),t.StringFormatter.register(Function,o,"Function"),t.StringFormatter.register(Function,o,"function")}("undefined"!=typeof exports&&"undefined"!=typeof global?global:window);